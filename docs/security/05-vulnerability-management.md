# Vulnerability management

Last updated: 2025-12-17

This document defines how the project discovers, triages, fixes, and communicates security vulnerabilities across the platform, including hosts, control plane services, and shipped client software.

## Goals

- Reduce exposure time to known vulnerabilities.
- Keep dependency inventory accurate and reviewable.
- Provide predictable patch timelines and customer communication.
- Prevent regressions via automated checks and staged rollouts.

## Scope

In scope components:

- Host OS and kernel
- Firecracker and microVM tooling
- Host agent and node identity plumbing
- Control plane services and APIs
- Edge ingress components
- CLI binaries and update channels
- Web console and web terminal
- Build and image fetch pipeline
- Observability pipeline handling sensitive data

Out of scope:
- Vulnerabilities inside customer application code, except where platform behavior can reduce impact (isolation, defaults, guardrails).

## Discovery sources

- Automated dependency scanning (SCA) for all repos.
- Container image scanning for base images used by platform components.
- Periodic host vulnerability scans and configuration audits.
- CVE monitoring for Firecracker, Linux kernel, WireGuard, and critical libraries.
- Fuzzing and security testing for parsing heavy components (API, edge protocols).
- External reports via a responsible disclosure channel.

## Inventory and SBOM

- Maintain SBOMs for platform components and CLI releases.
- Track versions for:
  - host kernel and base OS image
  - Firecracker version
  - control plane service images by digest
  - CLI build metadata and dependencies
- Require exact versions in deployment manifests for platform components.

## Triage and severity

Use a consistent severity model (for example CVSS plus context).

Inputs:
- exploitability
- impact scope (tenant, host, fleet, control plane)
- availability impact
- exposure (internet facing vs internal)

Suggested severity bands:

- Critical: likely remote compromise or cross tenant data exposure.
- High: privilege escalation, sensitive data exposure, or significant integrity impact.
- Medium: meaningful but constrained impact, mitigations exist.
- Low: minor impact or hard to exploit.

## Patch timelines

Target service level objectives.

- Critical
  - mitigation within 24 hours
  - patch rollout as soon as tested, typically within 72 hours
- High
  - patch within 7 days
- Medium
  - patch within 30 days
- Low
  - patch in a normal release cycle

Notes:
- Host kernel and Firecracker issues may require coordinated reboots. Plan for rolling reboots with drain and reschedule.
- If a patch risks stability, apply mitigations first and communicate clearly.

## Fix workflow

1. Validate report and reproduce in a controlled environment.
2. Determine blast radius and affected components.
3. Apply mitigation if immediate patch is not available.
4. Implement patch with tests and regression coverage.
5. Roll out to staging and canary nodes first.
6. Roll out to the fleet with monitoring for regressions.
7. Publish customer facing advisory when appropriate.

## Communication and disclosure

- Provide a security contact (email) for responsible disclosure.
- Acknowledge receipt quickly and keep reporter informed.
- Publish advisories for issues that affect customer security posture.
- Coordinate embargoes for upstream vulnerabilities when required.
- Avoid publishing exploit details that materially increase risk before patches are widely deployed.

## Customer facing controls

- Allow customers to pin images by digest and enforce signature verification.
- Provide visibility into platform component versions and patch status.
- Provide guidance for customer workload patching (base image updates, dependency scanning).

## Security testing program

- Code review requirements for security sensitive areas (authz, secrets, edge parsing, host agent).
- Regular penetration testing focused on:
  - authz bypass
  - secret exfiltration paths
  - tenant escape
  - supply chain
- Continuous fuzzing for parsers and protocol handlers.
- Incident simulations and tabletop exercises.

## Metrics

Track these over time.

- Mean time to remediate by severity.
- Percentage of assets covered by scanning and SBOM.
- Patch compliance for hosts and control plane images.
- Number of authz bugs found in review vs production.
- Secret leakage incidents (should be zero) and near misses.

## Exceptions

- Any exception to patch timelines or security controls must be documented with:
  - reason
  - risk assessment
  - compensating controls
  - expiry date
