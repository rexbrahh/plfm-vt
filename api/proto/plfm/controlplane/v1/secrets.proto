syntax = "proto3";

package plfm.controlplane.v1;

import "google/protobuf/timestamp.proto";

// Secret bundle resource for environment secrets.
message SecretBundle {
  // Secret bundle identifier.
  string id = 1;
  // Organization identifier.
  string org_id = 2;
  // Application identifier.
  string app_id = 3;
  // Environment identifier.
  string env_id = 4;
  // Secret format name.
  string format = 5;
  // Current version identifier.
  optional string current_version_id = 6;
  // Creation timestamp.
  google.protobuf.Timestamp created_at = 7;
  // Last update timestamp.
  google.protobuf.Timestamp updated_at = 8;
}

// Secret version resource.
message SecretVersion {
  // Secret version identifier.
  string id = 1;
  // Secret bundle identifier.
  string bundle_id = 2;
  // Organization identifier.
  string org_id = 3;
  // Environment identifier.
  string env_id = 4;
  // Secret format name.
  string format = 5;
  // Hash of the secret data.
  string data_hash = 6;
  // Creation timestamp.
  google.protobuf.Timestamp created_at = 7;
}

// Response payload for secret bundle listings.
message ListSecretBundlesResponse {
  // Secret bundles in the response.
  repeated SecretBundle items = 1;
  // Pagination cursor for the next page.
  optional string next_cursor = 2;
}

// Response payload for secret version listings.
message ListSecretVersionsResponse {
  // Secret versions in the response.
  repeated SecretVersion items = 1;
  // Pagination cursor for the next page.
  optional string next_cursor = 2;
}
