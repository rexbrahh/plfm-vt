syntax = "proto3";

package plfm.events.v1;

import "google/protobuf/timestamp.proto";

// Payload for secret bundle creation events.
message SecretBundleCreatedPayload {
  // Secret bundle identifier.
  string bundle_id = 1;
  // Organization identifier.
  string org_id = 2;
  // Application identifier.
  string app_id = 3;
  // Environment identifier.
  string env_id = 4;
  // Secret format name.
  string format = 5;
  // Creation timestamp.
  google.protobuf.Timestamp created_at = 6;
}

// Payload for secret bundle version selection events.
message SecretBundleVersionSetPayload {
  // Secret bundle identifier.
  string bundle_id = 1;
  // Organization identifier.
  string org_id = 2;
  // Environment identifier.
  string env_id = 3;
  // Secret version identifier.
  string version_id = 4;
  // Secret format name.
  string format = 5;
  // Hash of the secret data.
  string data_hash = 6;
  // Version selection timestamp.
  google.protobuf.Timestamp updated_at = 7;
}
